package com.multi.spring.board.controller;

import java.util.List;

import javax.servlet.http.HttpSession;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;

import com.multi.spring.board.model.dto.BoardDTO;
import com.multi.spring.board.service.BoardService;
@Controller
@RequestMapping("/board")
public class BoardController {
	
	private final BoardService boardService;
	
	@Autowired //생성자 주입
	public BoardController(BoardService boardService) {
		super();
		this.boardService = boardService;
	}
	
	@RequestMapping("/main")
	public String main() {
		return "redirect:/index.jsp";
	}
	
	@RequestMapping("/bbs")
	public void bbsMain() {

	}
	
	@RequestMapping("/bbs_insert_form")
	public void insertForm() {

	}
	
	@RequestMapping("/bbs_delete_form")
	public void deleteForm() {

	}
	
	@RequestMapping("/bbs_update_form")
	public void updateForm() {

	}
	
	@RequestMapping("/bbs_one_form")
	public void oneForm() {

	}
	
	@PostMapping("/bbs_insert")
	public String insertBoard(BoardDTO boardDTO, HttpSession session) throws Exception {

		System.out.println("insertBoard ==>" + boardDTO);

		boardService.insertBoard(boardDTO);
		session.setAttribute("msg", "게시글 작성!");

		return "redirect:/board/bbs";
	}
	
	@GetMapping("/bbs_list")
	public void selectList(Model model) throws Exception {
		List<BoardDTO> list = boardService.selectList();

		model.addAttribute("list", list);
	}
	
	@GetMapping("/bbs_delete")
	public String deleteBoard(String no, HttpSession session) throws Exception {

		boardService.deleteBoard(no);
		session.setAttribute("msg", "게시글 삭제 성공");
		return "redirect:/board/bbs";
	}
	
	@PostMapping("/bbs_update")
	public String updateBoard(BoardDTO boardDTO, HttpSession session) throws Exception {
		boardService.updateBoard(boardDTO);
		session.setAttribute("msg", "게시글 수정");
		return "redirect:/board/bbsr";
	}
	
	@GetMapping("/bbs_one")
	public void selectBoard(String no, Model model) throws Exception {

		BoardDTO boardDTO = boardService.selectBoard(no);
		model.addAttribute("boardDTO", boardDTO);
	}
	
	
	
	
	
	
	

}
